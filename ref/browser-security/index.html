<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.72.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Browser security&nbsp;&ndash;&nbsp;MM3* lab</title><meta name="description" content="A brief description of Hugo Shortcodes" /><link rel="stylesheet" href="/css/core.min.ab0d3a5e22e3151993291f6d9b37cc3b84ccda3453f319de36b3694f9fbe6554d6330ff9f681e7aacbd495939a9c0262.css" integrity="sha384-qw06XiLjFRmTKR9tmzfMO4TM2jRT8xneNrNpT5&#43;&#43;ZVTWMw/59oHnqsvUlZOanAJi"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Browser security" />
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,600;0,700;1,600;1,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Marcellus+SC&display=swap" rel="stylesheet">


<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="img/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#fff">
<body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">MM3* lab</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/projects/">Projects</a><a class="nav item" href="/about/">About</a><a class="mode iconfont icon-adjust"></a>
</nav></div></span></div><div class="site slogan"><span class="title">- Cryptography, Security, Privacy - </span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Browser security</h1><p class="article date">Mar 10, 2019</p></section><article class="article markdown-body"><h1 id="13-browser-security">13. Browser Security</h1>
<h5 id="browser-security--web-security">Browser Security &amp; Web Security</h5>
<p>Web browser: (client side)</p>
<ul>
<li>
<p>Attacks target browser security weaknesses</p>
</li>
<li>
<p>Result in:</p>
<ul>
<li>
<p>Malware installation (keyloggers, bot-nets)</p>
</li>
<li>
<p>Document theft from corporate network</p>
</li>
<li>
<p>Loss of private data</p>
</li>
</ul>
</li>
</ul>
<p>Web application code: (server side)</p>
<ul>
<li>
<p>Runs at web site: banks, e-merchants, blogs</p>
</li>
<li>
<p>Written in PHP, ASP, JSP, Ruby, &hellip;</p>
</li>
<li>
<p>Many potential bugs: XSS, XSRF, SQL injection</p>
</li>
<li>
<p>Attacks lead to stolen CC#, defaced sites.</p>
</li>
</ul>
<h3 id="131-web-basics">13.1 Web Basics</h3>
<p>HTTP(S) is</p>
<ul>
<li>
<p>Simple and widely used</p>
</li>
<li>
<p>Stateless</p>
</li>
<li>
<p>Unencrypted without S</p>
</li>
<li>
<p>Secured with S</p>
</li>
</ul>
<p>HTTP Requests and Responses</p>
<ul>
<li>
<p>Requests are from client to server</p>
</li>
<li>
<p>Responses from server to client with requested content or error code</p>
</li>
</ul>
<p>URL (Unified Resource Locator)</p>
<ul>
<li>
<p><code>protocol://[user[:password]@]hostname[:port]/path/file?query</code></p>
<p><code>http://www.cased.de:81/topics/forschung.html?id=1</code></p>
</li>
<li>
<p>Special characters are encoded as hex</p>
</li>
</ul>
<p>Nearly all web browsers support HTTPS</p>
<h3 id="132-https-in-browsers">13.2 HTTPS in Browsers</h3>
<ul>
<li>
<p>Every current browser has the ability to communicate over HTTPS</p>
<ul>
<li>
<p>Confidentiality</p>
</li>
<li>
<p>Integrity</p>
</li>
<li>
<p>Transparent to the user</p>
</li>
</ul>
</li>
<li>
<p>HTTPS is indicated by a https as a <strong>protocol</strong> and the <strong>standard port is 443</strong></p>
<ul>
<li>
<p>Self-signed</p>
</li>
<li>
<p>Issued by a certificate authority after a certificate request</p>
</li>
</ul>
</li>
<li>
<p>Extended Validation(EV)-Certificates should ensure that <mark>the server authority</mark> is checked</p>
<ul>
<li>
<p>Extended Validation, defined by CA/Browser Forum (<a href="http://www.cabforum.org">www.cabforum.org</a>)</p>
</li>
<li>
<p>Documents must be sent to certificate issuer</p>
</li>
</ul>
</li>
</ul>
<p>Certificates:</p>
<ol>
<li>
<p>Extended Validation (EV) Certificate and HTTPS Protocol  =&gt; Quite secure and serious</p>
</li>
<li>
<p>Known Certificate Authority and HTTPS Protocol  =&gt; Secure but not validated</p>
</li>
<li>
<p>No Certificate Authority and HTTP Protocol  =&gt; Attacker.com not a good attempt</p>
</li>
<li>
<p>HTTPS Protocol, self-signed after red warning  =&gt; Spelling similarity. Be careful !</p>
</li>
</ol>
<p>Remember <a href="https://www.xudongz.com/blog/2017/idn-phishing/"target="_blank">IDN Homograph attack</a></p>
<ul>
<li>&ldquo;аpple.com&rdquo; uses the Cyrillic &ldquo;а&rdquo; (U+0430) rather than the ASCII &ldquo;a&rdquo; (U+0061)</li>
</ul>
<h3 id="133-basic-browser-security-concepts">13.3 Basic Browser Security Concepts</h3>
<h5 id="1331-same-origin-policy-sop">13.3.1 Same Origin Policy (SOP)</h5>
<p>SOP isolates origins/websites from each other.</p>
<p>Origin: protocol, domain, port</p>
<p>Origin A can access origin B&rsquo;s DOM if match on (protocol, domain, port).</p>
<ul>
<li>
<p>Safe to visit <strong>two pages</strong> at the same time</p>
<p>=&gt; Address bar distinguishes them</p>
</li>
<li>
<p><strong>Allow safe delegation</strong></p>
<p>=&gt; Embed another web site safely</p>
</li>
</ul>
<p>Some <strong>exceptions</strong> exist</p>
<h6 id="possible-ways-to-embed-other-content">Possible Ways to Embed Other Content</h6>
<ul>
<li>
<p>Popup windows (can open every site)</p>
<ul>
<li>
<p>with hyperlinks</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://www.b.com&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;foo&#34;</span><span class="p">&gt;</span>click here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>with Javascript</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">mywin</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&#34;http://www.b.com&#34;</span><span class="p">,</span><span class="s2">&#34;foo&#34;</span><span class="p">,</span><span class="s2">&#34;width=10,height=10&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Properties of remote window accessible</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">mywin</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span>
<span class="nx">mywin</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s1">&#39;http://www.c.com&#39;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>Frames</p>
<ul>
<li>Can load some sites in the e.g. <code>iframe</code> =&gt; no communication between frames</li>
</ul>
</li>
</ul>
<h6 id="embedded-content-permissions">Embedded Content Permissions</h6>
<ul>
<li>
<p>Images (no scripting possible)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">http://site.com/a.png</span> <span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Scripts</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;http://site.com/script.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>CSS</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/css&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://site.com/theme.css&#34;</span> <span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Objects (flash)</p>
<p><strong>AllowScriptAccess</strong>: allows <u>flash object</u> to <u>communicate with external scripts</u>, <u>navigate frames</u>, and <u>open windows</u> =&gt; do not use flash anymore</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!-- using swfobject.js script --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="kd">var</span> <span class="nx">so</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SWFObject</span><span class="p">(</span><span class="s1">&#39;http://site.com/flash.swf&#39;</span><span class="p">,</span> <span class="p">...);</span> 
    <span class="nx">so</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;allowscriptaccess&#39;</span><span class="p">,</span> <span class="s1">&#39;always&#39;</span><span class="p">);</span> 
    <span class="nx">so</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;flashdiv&#39;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h6 id="importing-scripts-from-3rd-party-providers">Importing Scripts from 3rd Party Providers</h6>
<p>Loads JavaScript from a remote server (SOP Exception)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">http://server.com/getseal.js</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Script has privileges of importing page, NOT source server</p>
<ul>
<li>Script is executed in context of the importing page.</li>
</ul>
<p>Can script other pages in this origin, load more scripts</p>
<ul>
<li>
<p>Ajax request/responses from source server is not possible</p>
</li>
<li>
<p>3rd party ad should not read/write enclosing DOM</p>
</li>
</ul>
<p>Other forms of importing</p>
<h6 id="frame-navigation-descendant-policy">Frame Navigation Descendant Policy</h6>
<ul>
<li>
<p>Descendant Policy: A frame can navigate its descendants 后代 (current)</p>
<img title="" src="file:///Users/rozen/Desktop/ITS/2020SS/3%20IT-Sicherheit/note/img/1593788158424.jpg" alt="1593788158424.jpg" width="465">
<p><code>iframes</code>: It is <strong>not possible to read</strong> any content of an iframe; it is just possible to change the location of the iframe.</p>
</li>
<li>
<p>Past Policies</p>
<ul>
<li>
<p>Permissive Policy - A frame can navigate any frame.</p>
</li>
<li>
<p>Window Policy - A frame can navigate frames in its own window.</p>
</li>
<li>
<p>Child Policy - A frame can navigate its children</p>
</li>
</ul>
</li>
</ul>
<h6 id="frame-communication-cross-origin-interaction">Frame Communication: Cross-origin Interaction</h6>
<p>Sites often need to communicate:</p>
<ul>
<li>
<p>Google AdSense:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;http://googlesyndication.com/show_ads.js&#34;</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Mashups (google map)</p>
</li>
</ul>
<p>Primary method:</p>
<ul>
<li>
<p>script inclusion</p>
<p>site A does:  <code>&lt;script src=//siteB.com/script.js&gt;</code></p>
<p>Script from B runs in A&rsquo;s origin  =&gt; full control over A&rsquo;s DOM</p>
<p>Note: to communicate with B, site A gives B full control!</p>
</li>
</ul>
<h6 id="html5-web-messaging-windowpostmessage">HTML5 Web Messaging: <code>window.postMessage</code></h6>
<p>API for <strong>inter-frame communication</strong>:</p>
<ul>
<li>
<p>supported in latest versions of many browsers</p>
</li>
<li>
<p>A network-like channel between frames</p>
</li>
</ul>
<p>postMessage Communication</p>
<ul>
<li>
<p>A.com contains an iframe element with content of B.com</p>
</li>
<li>
<p>A calls <code>postMessage()</code> on the Window object of document B, then a message event will be fired on that object, marked as originating from the Window of document A.</p>
</li>
</ul>
<p>postMessage Syntax</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">targetWindow</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">targetOrigin</span><span class="p">);</span>
<span class="c1">// If the origin of the target window doesn&#39;t match the given targetOrigin
</span><span class="c1">// the message is discarded, to avoid information leakage
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>A.com</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">iframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span><span class="s2">&#34;Hello from A.com!&#34;</span><span class="p">,</span> <span class="s2">&#34;http://b.com/&#34;</span><span class="p">);</span>
<span class="c1">//targetOrigin: b.com
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>B.com</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;message&#34;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">origin</span> <span class="o">==</span> <span class="s2">&#34;http://a.com&#34;</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="p">...</span> <span class="p">}</span> <span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>&ldquo;targetOrigin&rdquo; Flaws</p>
<ul>
<li>
<p>What goes wrong, if you do not use targetOrigin ?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"> <span class="nx">iframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span><span class="s2">&#34;Attack at dawn!&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>Always specify an exact target origin, not *, when you use postMessage to send data to other windows.</p>
</li>
<li>
<p>A malicious site can <strong>change the location</strong> of the window without your knowledge, and therefore it can intercept the data sent using postMessage.</p>
<img title="" src="file:///Users/rozen/Desktop/ITS/2020SS/3%20IT-Sicherheit/note/img/1593789954314.jpg" alt="1593789954314.jpg" width="531">
</li>
</ul>
<h5 id="1332-http-strict-transport-security-rfc6797">13.3.2 HTTP Strict Transport Security (RFC6797)</h5>
<p>&ldquo;This specification defines a mechanism enabling web sites to declare themselves <u>accessible only via secure connections</u> and/or for users to be able to <u>direct their user agent(s) to interact with given sites only over secure connections</u>.&rdquo;</p>
<ul>
<li>
<p>User Agent will convert URI to secure URI <strong>before</strong> dereferencing</p>
</li>
<li>
<p>helps against active and passive attackers, but not malware or phishing</p>
</li>
<li>
<p>countermeasure for <strong>ssl stripping attacks</strong></p>
</li>
</ul>
<h6 id="autofill-attack">Autofill Attack</h6>
<ul>
<li>
<p>Browsers supply autofill mechanisms (also for credit cards)</p>
</li>
<li>
<p>fill in all details of the user in corresponding fields</p>
</li>
<li>
<p>Included fields which are not visible to the user (password, credit card number, &hellip;) will also get filled</p>
</li>
</ul>
<h3 id="134-cookies">13.4 Cookies</h3>
<h6 id="types-of-cookies">Types of Cookies</h6>
<ol>
<li>
<p>Session Cookie (First-Party Cookie):</p>
<ul>
<li>Temporary</li>
</ul>
</li>
<li>
<p>Persistent/tracking Cookie (First-Party or Third-Party Cookie)</p>
<ul>
<li>Longer lifetime</li>
</ul>
</li>
<li>
<p>Third-Party Cookie</p>
<ul>
<li>Set from other web site</li>
</ul>
</li>
</ol>
<p>HttpOnly Cookie - secure Cookie</p>
<p>Same-Site Cookie (Google Chrome, Opera)</p>
<p>Supercookie, Zombie cookie</p>
<h6 id="setting--deleting-cookies-by-server">Setting / Deleting Cookies by Server</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-http" data-lang="http"><span class="err">HTTP Header: 
</span><span class="err">Set-cookie:    NAME = VALUE;
</span><span class="err">               domain = a.com;    &#34;when to send&#34;
</span><span class="err">               path = /;          &#34;when to send&#34;
</span><span class="err">               secure = true;     &#34;only send over SSL&#34;
</span><span class="err">               expires = NULL;    &#34;when to expire&#34;
</span><span class="err">               HttpOnly;       
</span><span class="err">               SameSite
</span><span class="err">
</span><span class="err">if expires=NULL: this session only
</span><span class="err">if expires is in the past: delete the cookie
</span></code></pre></td></tr></table>
</div>
</div><p>Setting Rules</p>
<ul>
<li>domain: any <strong>domain-suffix</strong> of <strong>URL-hostname</strong>, except TLD</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Example: host = &#34;login.site.com&#34;
allowed domains:    login.site.com
                    .site.com
disallowed domains: user.site.com
                    othersite.com
                    .com
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>login.site.com</code> can set cookies for it&rsquo;s own host (login.site.com) and those
above ( .site.com ) but not for another site or TLD</p>
</li>
<li>
<p>path: can be set to anything (def. / )  =&gt; If set, browser will send cookie only <strong>if domain and path fit</strong></p>
</li>
</ul>
<p>Cookies are Identified by (name,domain,path,[secure])</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cookie 1
name = userid
value = test
domain = login.site.com 
path = /
secure

cookie 2
name = userid 
value = test123 
domain = .site.com 
path = /
non-secure
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Both cookies stored in browser&rsquo;s cookie storage;</p>
</li>
<li>
<p>both are in scope of login.site.com</p>
</li>
</ul>
<h6 id="cookie-examples">Cookie Examples</h6>
<p>both set by <strong>login.site.com</strong></p>
<ol>
<li>
<p><code>http://checkout.site.com/</code> =&gt; cookie: <code>userid=u2</code></p>
</li>
<li>
<p><code>http://login.site.com/</code> =&gt; cookie: <code>userid=u2</code></p>
</li>
<li>
<p><code>https://login.site.com/</code> =&gt; cookie: <code>userid=u1; userid=u2</code>(arbitrary order)</p>
</li>
</ol>
<h6 id="current-browsers-different-behavior">Current Browsers: Different behavior</h6>
<p>If you want to test cookies, please be sure that the browser set the value you want to be set; you need to test multiple browsers to guarantee functionality.</p>
<p>Often the Domain name is stored with a leading <code>.</code></p>
<ul>
<li>Means that all subdomains are affected.</li>
</ul>
<h6 id="client-side-readwrite-documentcookie">Client-Side Read/Write: document.cookie</h6>
<ul>
<li>
<p>Setting a cookie in JavaScript</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="s2">&#34;name=value; expires=...; &#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Reading cookies</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span>
<span class="c1">//prints string containing all cookies available 
</span><span class="c1">//for document (based on [protocol], domain, path)
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Deleting a cookie</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="s2">&#34;name=...; expires= Thu, 01-Jan-70&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h6 id="httponly-property-of-cookies">HttpOnly Property of Cookies</h6>
<ul>
<li>
<p>Address bar of Browser:</p>
<ul>
<li>
<p><code>javascript: alert(document.cookie)</code>=&gt; Displays all <strong>non HttpOnly-Cookies</strong> in the side context</p>
</li>
<li>
<p>Cookie is set to HttpOnly =&gt; invisible to JavaScript</p>
</li>
</ul>
</li>
<li>
<p>Cookie sent over HTTP(s), but not accessible to scripts</p>
<ul>
<li>
<p><strong>cannot</strong> be read via <strong>document.cookie</strong></p>
</li>
<li>
<p>Also blocks access from <strong>XMLHttpRequest headers</strong></p>
</li>
</ul>
</li>
<li>
<p>Helps prevent cookie theft via Cross Site Scripting</p>
<ul>
<li>but does not stop most other risks of XSS bugs</li>
</ul>
</li>
</ul>
<h6 id="samesite-property-of-cookies">SameSite Property of Cookies</h6>
<p>Cookie should only be sent with requests initiated from the same registrable domain.</p>
<ul>
<li>
<p>Mitigates the risk of CSRF and information leakage attack</p>
</li>
<li>
<p><a href="https://web.dev/samesite-cookies-explained/"target="_blank">SameSite cookies explained</a></p>
</li>
</ul>
<h6 id="cookie-protocol-problems">Cookie Protocol Problems</h6>
<ul>
<li>
<p>Server is blind:</p>
<ul>
<li>
<p>Does not see cookie attributes (e.g. secure)</p>
</li>
<li>
<p>Does not see which domain set the cookie</p>
</li>
<li>
<p>Server processes cookies sent to it</p>
</li>
</ul>
</li>
<li>
<p>Server only sees: <code>Cookie: NAME=VALUE</code></p>
<ul>
<li>
<p>Cookie Parameters remain in the browser</p>
</li>
<li>
<p>Plausibility checks are difficult</p>
</li>
</ul>
</li>
<li>
<p>No encryption or integrity checks are included</p>
<ul>
<li>Must be implemented on web application or client side</li>
</ul>
</li>
</ul>
<h3 id="135-private-browsing-concept">13.5 Private Browsing Concept</h3>
<h6 id="private-browsing-mode">Private Browsing Mode</h6>
<ul>
<li>
<p>Web pages opened and files downloaded</p>
<p>will not be recorded in the browser / download history</p>
</li>
<li>
<p>All new cookies are deleted after you close all incognito windows</p>
</li>
<li>
<p>Changes made to bookmarks and general settings while in incognito mode are always saved</p>
</li>
</ul>
<h6 id="not-as-private-as-one-might-think">Not as Private as One Might Think</h6>
<ul>
<li>
<p>Browsing in incognito mode only keeps the browser from storing information about the websites that you&rsquo;ve visited</p>
</li>
<li>
<p>The websites that you visit may still have records of your visit</p>
</li>
<li>
<p>Any files saved to your computer or mobile devices will still remain</p>
</li>
<li>
<p>For example, if you sign in to your Google Account on <code>http://www.google.co.uk</code> while in incognito mode, your subsequent web searches are recorded in your Google Web History</p>
</li>
</ul>
<h3 id="136-summary-tracking-countermeasures">13.6 Summary: Tracking Countermeasures</h3>
<ol>
<li>
<p>Cookie opt-out (Network Advertising Initiative)</p>
<ul>
<li>
<p>Needs enabled 3rd party cookie</p>
</li>
<li>
<p>Ensure that opt-out cookies will not be deleted</p>
</li>
<li>
<p>Trust in anonymous advertising</p>
</li>
</ul>
</li>
<li>
<p>Do-Not-Track header</p>
<ul>
<li>Not supported by many advertising companies</li>
</ul>
</li>
<li>
<p>3rd party cookie blocking / manually clearing browser data</p>
</li>
<li>
<p>TOR / JonDonym (IP hiding – cookies?)</p>
</li>
<li>
<p>Add-ons (no-script,uBlock Matrix, Cookie AutoDelete, ublock Origin&hellip;)</p>
<ul>
<li>
<p>Can be detected &amp; circumvented</p>
</li>
<li>
<p>Identify the user (fingerprinting / analyzing blocking domain patterns)</p>
</li>
</ul>
</li>
<li>
<p>Tracking Protection List (Internet Explorer) =&gt; [Fraunhofer SIT](<a href="https://www.sit.fraunhofer.de/de/angebote/projekte/tracking-protection-list/"target="_blank">Tracking Protection List - Fraunhofer SIT</a>)</p>
</li>
<li>
<p>Private Browsing?</p>
</li>
<li>
<p>Browser fingerprinting protection</p>
</li>
</ol>
</article><section class="article author"><img class="avatar" src="/img/2.png" alt><p class="name">Roesinn</p><div class="bio"><strong>Security</strong> MSc. Student <br> <strong>Web</strong> Designer</div><div class="details"></div>
</section></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/ref/markdown-syntax/"><span class="iconfont icon-article-left"></span>Markdown Syntax Guide</a></p><p><a class="link" href="/ref/network-security/"><span class="iconfont icon-article-right"></span>Network security</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://roesinn.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2020 roesinn</p>
</div>
</section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-168886235-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</body>

</html>